#!/usr/bin/env bash

# Function to print domain and subdomain information
print_domain_subdomain() {
    local fqdn="$1"
    local subdomain="$2"

    # Use dig to get the DNS record
    local result=$(dig "$fqdn" +noall +answer)
    if [[ -z $result ]]; then
        echo "The subdomain ${subdomain} does not exist or has no DNS records."
        return
    fi

    # Extract the record type and destination
    local record_type=$(echo "$result" | awk 'NR==1 {print $4}')
    local destination=$(echo "$result" | awk 'NR==1 {print $5}')

    echo "The subdomain ${subdomain} is a ${record_type} record and points to ${destination}"
}

# Check if domain argument is provided
if [[ -z $1 ]]; then
    echo "Usage: $0 domain [subdomain]"
    exit 1
fi

domain=$1
subdomain=$2

# If subdomain is provided, display information for that subdomain
if [[ -n $subdomain ]]; then
    print_domain_subdomain "$subdomain.$domain" "$subdomain"
else
    # If no subdomain is provided, display information for the default subdomains
    for sub in www lb-01 web-01 web-02; do
        print_domain_subdomain "$sub.$domain" "$sub"
    done
fi
